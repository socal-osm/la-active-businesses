# la-active-businesses
A repo to import L.A.'s active businesses into OpenStreetMap

## Data sources
- [L.A. County's address point database](http://egis3.lacounty.gov/dataportal/2012/06/19/la-county-address-points/) offers more specific geocoding by lat/lon than the 
- [L.A. City listing of active businesses](https://data.lacity.org/A-Prosperous-City/Listing-of-Active-Businesses/6rrh-rzua) which has all the pertinent information for the business

## Next steps
1. Test data
2. Define import strategy
3. Define update strategy

## Testing steps
Download both data source files and import into a Postgres database.

Join both using code like this (replace la_businesses and la_addresses with whatever you named those tables):
```
SELECT 
	replace(initcap(lower(la_businesses."DBA NAME")),'''S','''s') as name, 
	la_businesses."STREET ADDRESS",
	la_businesses."CITY",
	la_businesses."PRIMARY NAICS DESCRIPTION",
	la_businesses."LOCATION START DATE",
	SUBSTR("LOCATION START DATE", 7, 4)||'-'||SUBSTR("LOCATION START DATE", 1, 2)||'-'||SUBSTR("LOCATION START DATE", 4, 2) as "start_date",
	la_addresses."X" as lon,
	la_addresses."Y" as lat,
	la_addresses."Number" as "addr:housenumber",
	la_addresses."PreDir"||' '||la_addresses."StreetName"||' '||la_addresses."PostType" as "addr:street",
	la_addresses."ZipCode" as "addr:postcode",
	la_addresses."LegalComm" as "addr:city"
FROM la_businesses
INNER JOIN la_addresses ON la_addresses."Number"||' '||la_addresses."PreDirAbbr"||' '||upper(la_addresses."StreetName")||' '||upper(la_addresses."PostType") = la_businesses."STREET ADDRESS"
WHERE la_businesses."DBA NAME" LIKE '%DONUT%'
```

Which outputs

| name                                               | STREET ADDRESS               | CITY          | PRIMARY NAICS DESCRIPTION                                                           | LOCATION START DATE | start_date | lon                  | lat                | addr:housenumber | addr:street                | addr:postcode | addr:city      |
|----------------------------------------------------|------------------------------|---------------|-------------------------------------------------------------------------------------|---------------------|------------|----------------------|--------------------|------------------|----------------------------|---------------|----------------|
| Sexy Donut                                         | 4003 S SAN PEDRO STREET      | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 01/01/1991          | 1991-01-01 | -118.268342050137534 | 34.010900004654204 | 4003             | South San Pedro Street     | 90011         | Los Angeles    |
| New Donut & Water                                  | 1502 E VERNON AVENUE         | LOS ANGELES   | Fruit & vegetable preserving & speciality food mfg.                                 | 11/24/2009          | 2009-11-24 | -118.247497002206487 | 34.003745814600961 | 1502             | East Vernon Avenue         | 90011         | Los Angeles    |
| World Cup Cafe Dinner & Donuts                     | 629 W ANAHEIM STREET         | WILMINGTON    | Bakeries & tortilla mfg.                                                            | 03/27/2013          | 2013-03-27 | -118.269694725050016 | 33.779766954208888 | 629              | West Anaheim Street        | 90744         | Los Angeles    |
| Super Donut                                        | 1827 S VERMONT AVENUE        | LOS ANGELES   | Home furnishings stores                                                             | 12/17/2004          | 2004-12-17 | -118.29179025809367  | 34.040790334968349 | 1827             | South Vermont Avenue       | 90006         | Los Angeles    |
| L.A Donuts & Croissant                             | 102 S VERMONT AVENUE         | LOS ANGELES   | All other miscellaneous store retailers (including tobacco, candle, & trophy shops) | 04/03/2014          | 2014-04-03 | -118.291451151187275 | 34.072574243016589 | 102              | South Vermont Avenue       | 90004         | Los Angeles    |
| Winchells Donut House #9201                        | 928 W FLORENCE AVENUE        | LOS ANGELES   |                                                                                     | 10/20/2004          | 2004-10-20 | -118.29032242623488  | 33.974459767061568 | 928              | West Florence Avenue       | 90044         | Los Angeles    |
| Margarita Gonzalez Yum Yum Donuts Franchise #9352e | 540 S GAFFEY STREET          | SAN PEDRO     | All other miscellaneous store retailers (including tobacco, candle, & trophy shops) | 09/22/2010          | 2010-09-22 | -118.29214076263402  | 33.738964199593468 | 540              | South Gaffey Street        | 90731         | Los Angeles    |
| Yum Yum Donuts Franchise #58-E                     | 1608 S HOOVER STREET         | LOS ANGELES   | Limited-service eating places                                                       | 11/30/2011          | 2011-11-30 | -118.283941903088532 | 34.043364545873757 | 1608             | South Hoover Street        | 90006         | Los Angeles    |
| Yum Yum Donut Franchise #59d                       | 1608 S HOOVER STREET         | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 02/28/1996          | 1996-02-28 | -118.283941903088532 | 34.043364545873757 | 1608             | South Hoover Street        | 90006         | Los Angeles    |
| Larry's Donuts                                     | 5612 W MANCHESTER AVENUE     | LOS ANGELES   | Full-service restaurants                                                            | 09/02/1997          | 1997-09-02 | -118.379328435248453 | 33.959720279501973 | 5612             | West Manchester Avenue     | 90045         | Los Angeles    |
| 7 Stars Donuts And Sandwich                        | 1754 W SLAUSON AVENUE        | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 09/28/2011          | 2011-09-28 | -118.308467372461621 | 33.98899176382843  | 1754             | West Slauson Avenue        | 90047         | Los Angeles    |
| Daily Donuts                                       | 1100 N VERMONT AVENUE        | LOS ANGELES   | Limited-service eating places                                                       | 09/01/2011          | 2011-09-01 | -118.291539415928384 | 34.091188160976166 | 1100             | North Vermont Avenue       | 90029         | Los Angeles    |
| Daily Donut                                        | 11315 S FIGUEROA STREET      | LOS ANGELES   | Limited-service eating places                                                       | 03/23/2012          | 2012-03-23 | -118.282787216143021 | 33.931473900177416 | 11315            | South Figueroa Street      | 90044         | Los Angeles    |
| Winchells Donut House #9103                        | 3023 W FLORENCE AVENUE       | LOS ANGELES   |                                                                                     | 10/20/2004          | 2004-10-20 | -118.326295630504248 | 33.974718240873258 | 3023             | West Florence Avenue       | 90043         | Los Angeles    |
| Magee's Donuts                                     | 1402 W 6TH STREET            | LOS ANGELES   | Full-service restaurants                                                            | 03/15/2003          | 2003-03-15 | -118.26773550184339  | 34.055866715047266 | 1402             | West 6th Street            | 90017         | Los Angeles    |
| California Donuts                                  | 3540 W 3RD STREET            | LOS ANGELES   | Full-service restaurants                                                            | 01/06/1982          | 1982-01-06 | -118.293239355574485 | 34.068898644827705 | 3540             | West 3rd Street            | 90020         | Los Angeles    |
| Daily Donut                                        | 8524 S SAN PEDRO STREET      | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 05/03/2013          | 2013-05-03 | -118.269323106310338 | 33.960304450171819 | 8524             | South San Pedro Street     | 90003         | Los Angeles    |
| Olympic Donuts                                     | 2337 E 4TH STREET            | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 12/01/2014          | 2014-12-01 | -118.211977885474596 | 34.040889014191436 | 2337             | East 4th Street            | 90033         | Los Angeles    |
| Olympic Donuts                                     | 2337 E 4TH STREET            | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 12/01/2014          | 2014-12-01 | -118.16345013203788  | 33.771961138750406 | 2337             | East 4th Street            | 90814         | Long Beach     |
| Boston Cream Donuts                                | 1009 W ANAHEIM STREET        | WILMINGTON    |                                                                                     | 10/01/2004          | 2004-10-01 | -118.274513639040862 | 33.779496806845508 | 1009             | West Anaheim Street        | 90744         | Los Angeles    |
| Good Time Donut                                    | 2548 W TEMPLE STREET         | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 09/01/1998          | 1998-09-01 | -118.274729601858951 | 34.072334237292111 | 2548             | West Temple Street         | 90026         | Los Angeles    |
| King Donut                                         | 177 W MANCHESTER AVENUE      | LOS ANGELES   | Special food services (including food service contractors & caterers)               | 09/28/2009          | 2009-09-28 | -118.276431280236238 | 33.960251786726843 | 177              | West Manchester Avenue     | 90003         | Los Angeles    |
| Maggies Donuts                                     | 2616 W 6TH STREET            | LOS ANGELES   | Bakeries & tortilla mfg.                                                            |                     | --         | -118.281034902385457 | 34.062143028977466 | 2616             | West 6th Street            | 90057         | Los Angeles    |
| Yum Yum Donuts Franchise #19-J                     | 724 N HIGHLAND AVENUE        | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 11/19/2012          | 2012-11-19 | -118.338390357238794 | 34.084212855910017 | 724              | North Highland Avenue      | 90038         | Los Angeles    |
| Big Jim's Donuts                                   | 702 N VERMONT AVENUE         | LOS ANGELES   | All other miscellaneous store retailers (including tobacco, candle, & trophy shops) | 03/09/2005          | 2005-03-09 | -118.291519663591998 | 34.083983484452311 | 702              | North Vermont Avenue       | 90029         | Los Angeles    |
| Michalls Donut Shop                                | 3783 S WESTERN AVENUE        | LOS ANGELES   |                                                                                     | 01/01/2006          | 2006-01-01 | -118.309090954913259 | 34.017816576055026 | 3783             | South Western Avenue       | 90062         | Los Angeles    |
| Sam's Donut House                                  | 4325 S VERMONT AVENUE        | LOS ANGELES   | Limited-service eating places                                                       | 06/01/2008          | 2008-06-01 | -118.29173626700323  | 34.004701949319148 | 4325             | South Vermont Avenue       | 90037         | Los Angeles    |
| The Donut                                          | 1615 S GAFFEY STREET         | SAN PEDRO     | Bakeries & tortilla mfg.                                                            | 10/26/1981          | 1981-10-26 | -118.292557433467721 | 33.729309976218978 | 1615             | South Gaffey Street        | 90731         | Los Angeles    |
| Golden Donut / Louisiana Famous Fried Chicken      | 300 W FLORENCE AVENUE        | LOS ANGELES   |                                                                                     | 05/09/2006          | 2006-05-09 | -118.359753791885097 | 33.965221137168079 | 300              | West Florence Avenue       | 90301         | Inglewood      |
| The Best Donut                                     | 550 W PACIFIC COAST HIGHWAY  | WILMINGTON    | Limited-service eating places                                                       | 08/28/2014          | 2014-08-28 | -118.199093700332597 | 33.789546507196782 | 550              | West Pacific Coast Highway | 90806         | Long Beach     |
| The Best Donut                                     | 550 W PACIFIC COAST HIGHWAY  | WILMINGTON    | Limited-service eating places                                                       | 08/28/2014          | 2014-08-28 | -118.269099357281149 | 33.79066781843327  | 550              | West Pacific Coast Highway | 90744         | Los Angeles    |
| Kinly Donuts                                       | 2000 W MANCHESTER AVENUE     | LOS ANGELES   | Other food mfg. (including coffee, tea, flavoring, & seasonings)                    | 01/28/2014          | 2014-01-28 | -118.313600497343856 | 33.959804762827353 | 2000             | West Manchester Avenue     | 90047         | Los Angeles    |
| Maggie's Donut                                     | 2612 W 6TH STREET            | LOS ANGELES   | Full-service restaurants                                                            | 09/25/1998          | 1998-09-25 | -118.280887395208751 | 34.062065759306492 | 2612             | West 6th Street            | 90057         | Los Angeles    |
| Factory Donuts & Coffee Shop                       | 3763 E 3RD STREET            | LOS ANGELES   | Other food mfg. (including coffee, tea, flavoring, & seasonings)                    | 09/14/2010          | 2010-09-14 | -118.187199862270859 | 34.033523161859684 | 3763             | East 3rd Street            | 90063         | Unincorporated |
| Sam's Donut                                        | 5401 S FIGUEROA STREET       | LOS ANGELES   | Educational services (including schools, colleges, & universities)                  | 01/14/2008          | 2008-01-14 | -118.282869019589384 | 33.993092434102564 | 5401             | South Figueroa Street      | 90037         | Los Angeles    |
| Yum Yum Donuts #1                                  | 2633 N FIGUEROA STREET       | LOS ANGELES   | Special food services (including food service contractors & caterers)               | 09/22/2008          | 2008-09-22 | -118.22164707395153  | 34.084656998127265 | 2633             | North Figueroa Street      | 90065         | Los Angeles    |
| California Donuts                                  | 801 S ALVARADO STREET        | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 08/10/1993          | 1993-08-10 | -118.27814801768271  | 34.054792499963845 | 801              | South Alvarado Street      | 90057         | Los Angeles    |
| Yum Yum Donut Shop #9147                           | 5836 W MANCHESTER AVENUE     | LOS ANGELES   | Limited-service eating places                                                       | 01/02/2008          | 2008-01-02 | -118.384252037815273 | 33.960044787949343 | 5836             | West Manchester Avenue     | 90045         | Los Angeles    |
| Yum Yum Donut Shop #9147                           | 5836 W MANCHESTER AVENUE     | LOS ANGELES   | Limited-service eating places                                                       | 01/02/2008          | 2008-01-02 | -118.384275132857141 | 33.95971051589882  | 5836             | West Manchester Avenue     | 90045         | Los Angeles    |
| Yum Yum Donuts # 9147 D                            | 5836 W MANCHESTER AVENUE     | LOS ANGELES   | Limited-service eating places                                                       | 04/10/2014          | 2014-04-10 | -118.384252037815273 | 33.960044787949343 | 5836             | West Manchester Avenue     | 90045         | Los Angeles    |
| Yum Yum Donuts # 9147 D                            | 5836 W MANCHESTER AVENUE     | LOS ANGELES   | Limited-service eating places                                                       | 04/10/2014          | 2014-04-10 | -118.384275132857141 | 33.95971051589882  | 5836             | West Manchester Avenue     | 90045         | Los Angeles    |
| Usa Donuts & Croissants                            | 2934 E CESAR E CHAVEZ AVENUE | LOS ANGELES   | Full-service restaurants                                                            | 01/01/2003          | 2003-01-01 | -118.200702251806959 | 34.043356379458643 | 2934             | East Cesar E Chavez Avenue | 90033         | Los Angeles    |
| Glaze Donuts                                       | 5827 S FIGUEROA STREET       | LOS ANGELES   | Limited-service eating places                                                       | 10/09/2009          | 2009-10-09 | -118.282862457045056 | 33.988947166736644 | 5827             | South Figueroa Street      | 90044         | Los Angeles    |
| Top Donuts                                         | 841 W PACIFIC COAST HIGHWAY  | WILMINGTON    | Full-service restaurants                                                            | 06/01/1994          | 1994-06-01 | -118.273380938092771 | 33.790785086325187 | 841              | West Pacific Coast Highway | 90744         | Los Angeles    |
| Winchells Donut House #9517                        | 1213 S SOTO STREET           | LOS ANGELES   |                                                                                     | 10/20/2004          | 2004-10-20 | -118.21966418253875  | 34.027851332118253 | 1213             | South Soto Street          | 90023         | Los Angeles    |
| Uncle Barts Circus Donuts                          | 1500 W CARSON STREET         | TORRANCE      | Bakeries & tortilla mfg.                                                            | 07/01/1998          | 1998-07-01 | -118.213152111000952 | 33.831190727857312 | 1500             | West Carson Street         | 90810         | Long Beach     |
| Uncle Barts Circus Donuts                          | 1500 W CARSON STREET         | TORRANCE      | Bakeries & tortilla mfg.                                                            | 07/01/1998          | 1998-07-01 | -118.303993427044659 | 33.831342264982489 | 1500             | West Carson Street         | 90501         | Los Angeles    |
| Uncle Barts Circus Donuts                          | 1500 W CARSON STREET         | TORRANCE      | Bakeries & tortilla mfg.                                                            | 07/01/1998          | 1998-07-01 | -118.213152111000952 | 33.831190727857312 | 1500             | West Carson Street         | 90810         | Long Beach     |
| Uncle Barts Circus Donuts                          | 1500 W CARSON STREET         | TORRANCE      | Bakeries & tortilla mfg.                                                            | 07/01/1998          | 1998-07-01 | -118.213152111000952 | 33.831190727857312 | 1500             | West Carson Street         | 90810         | Long Beach     |
| Yum Yum Donuts #9309                               | 8139 W MANCHESTER AVENUE     | PLAYA DEL REY | Bakeries & tortilla mfg.                                                            | 09/28/2012          | 2012-09-28 | -118.43877606345454  | 33.958414556383389 | 8139             | West Manchester Avenue     | 90293         | Los Angeles    |
| Donut World Fresh Coffee Beans                     | 3130 S NORMANDIE AVENUE      | LOS ANGELES   | Limited-service eating places                                                       | 05/20/2006          | 2006-05-20 | -118.300045931688459 | 34.025722624119517 | 3130             | South Normandie Avenue     | 90007         | Los Angeles    |
| Spudnuts Donuts                                    | 3001 S FIGUEROA STREET       | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 01/01/2003          | 2003-01-01 | -118.278283806749883 | 34.024952619668831 | 3001             | South Figueroa Street      | 90007         | Los Angeles    |
| Winchells Donut House #9339                        | 716 N WESTERN AVENUE         | LOS ANGELES   |                                                                                     | 10/20/2004          | 2004-10-20 | -118.308950086559832 | 34.084018692504017 | 716              | North Western Avenue       | 90029         | Los Angeles    |
| Diamond Donut                                      | 4580 S CENTINELA AVENUE      | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 01/01/1994          | 1994-01-01 | -118.4213102332604   | 33.991560899902474 | 4580             | South Centinela Avenue     | 90066         | Los Angeles    |
| Big Mama's Donuts                                  | 5409 N FIGUEROA STREET       | LOS ANGELES   | Other miscellaneous mfg.                                                            | 07/26/2010          | 2010-07-26 | -118.196345588844025 | 34.10802959949406  | 5409             | North Figueroa Street      | 90042         | Los Angeles    |
| Winchells Donut House #9259                        | 1700 S WESTERN AVENUE        | LOS ANGELES   |                                                                                     | 10/20/2004          | 2004-10-20 | -118.308838633735675 | 34.042544814425348 | 1700             | South Western Avenue       | 90006         | Los Angeles    |
| Winchells Donut House #9393                        | 697 S HOOVER STREET          | LOS ANGELES   |                                                                                     | 10/20/2004          | 2004-10-20 | -118.284392177995656 | 34.060043269734848 | 697              | South Hoover Street        | 90005         | Los Angeles    |
| Slauson Donuts                                     | 3451 W SLAUSON AVENUE        | LOS ANGELES   | Bakeries & tortilla mfg.                                                            | 05/01/1993          | 1993-05-01 | -118.332651183269732 | 33.989127737457629 | 3451             | West Slauson Avenue        | 90043         | Los Angeles    |
| Slauson Donuts                                     | 3451 W SLAUSON AVENUE        | LOS ANGELES   | Limited-service eating places                                                       | 11/01/2015          | 2015-11-01 | -118.332651183269732 | 33.989127737457629 | 3451             | West Slauson Avenue        | 90043         | Los Angeles    |
| F & M Donuts And Cafe                              | 5117 S FIGUEROA STREET       | LOS ANGELES   | Special food services (including food service contractors & caterers)               | 12/14/2012          | 2012-12-14 | -118.282934529529427 | 33.996152850445725 | 5117             | South Figueroa Street      | 90037         | Los Angeles    |
| Winchells Donut House #9445                        | 101 W FLORENCE AVENUE        | LOS ANGELES   |                                                                                     | 10/20/2004          | 2004-10-20 | -118.27432707486426  | 33.974860380433931 | 101              | West Florence Avenue       | 90003         | Los Angeles    |
| Sl Donuts                                          | 4411 S MAIN STREET           | LOS ANGELES   | Full-service restaurants                                                            | 05/01/2010          | 2010-05-01 | -118.2742461373156   | 34.003426913438012 | 4411             | South Main Street          | 90037         | Los Angeles    |
| Sugar Donut                                        | 809 W VERNON AVENUE          | LOS ANGELES   | Full-service restaurants                                                            | 03/01/2007          | 2007-03-01 | -118.287564785159773 | 34.003853442952973 | 809              | West Vernon Avenue         | 90037         | Los Angeles    |

This has problems. For instance, there are 341 records in the business file `WHERE "DBA NAME" LIKE '%DONUT%'` instead of the 63 shown above. Probably because there's no matching address. Join script needs more refining and logic to catch items that don't hava perfect match. We're also seeing duplicates. And the NAICS DESCRIPTION field may not be easily translatable to OSM's tags.
